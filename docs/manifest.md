# Repository Manifest: rvg Package

This document outlines the structure and purpose of the files and directories within the `rvg` R package repository.

## Repository Files and Directories

```
.
├── .Rbuildignore
├── .gitattributes
├── .github/
│   ├── .gitignore
│   └── workflows/
│       ├── R-CMD-check.yaml
│       └── pkgdown.yaml
├── .gitignore
├── DESCRIPTION
├── NAMESPACE
├── NEWS.md
├── R/
│   ├── RcppExports.R
│   ├── defunct.R
│   ├── dml_pptx.R
│   ├── dml_xlsx.R
│   ├── fonts.R
│   ├── ph_with_vg.R
│   └── xl_add_vg.R
├── README.Rmd
├── README.md
├── _pkgdown.yml
├── cran-comments.md
├── inst/
│   └── logo.svg
├── man/
│   ├── body_add_vg.Rd
│   ├── dml.Rd
│   ├── dml_pptx.Rd
│   ├── dml_xlsx.Rd
│   ├── ph_with.dml.Rd
│   └── xl_add_vg.Rd
├── rvg.Rproj
├── src/
│   ├── .gitignore
│   ├── Makevars
│   ├── Makevars.ucrt
│   ├── Makevars.win
│   ├── RcppExports.cpp
│   ├── a_color.cpp
│   ├── a_color.h
│   ├── a_prstgeom.cpp
│   ├── a_prstgeom.h
│   ├── clipper.cpp
│   ├── clipper.h
│   ├── line_style.cpp
│   ├── line_style.h
│   ├── main_tree.cpp
│   ├── main_tree.h
│   ├── ooxml_dev.h
│   ├── ppr.cpp
│   ├── ppr.h
│   ├── pptx.cpp
│   ├── raster.cpp
│   ├── raster.h
│   ├── rpr.cpp
│   ├── rpr.h
│   ├── shapes.cpp
│   ├── shapes.h
│   ├── text.cpp
│   ├── text.h
│   ├── write_nv_pr.cpp
│   ├── write_nv_pr.h
│   ├── xfrm.cpp
│   ├── xfrm.h
│   └── xlsx.cpp
├── tests/
│   ├── testthat/
│   │   ├── test-bg.R
│   │   ├── test-dml-editable.R
│   │   ├── test-officer.R
│   │   ├── test-pptx-lines.R
│   │   ├── test-pptx-raster.R
│   │   ├── test-pptx-text.R
│   │   ├── test-pptx-xfrm.R
│   │   ├── test-xlsx-lines.R
│   │   ├── test-xlsx-raster.R
│   │   ├── test-xlsx-text.R
│   │   └── test-xlsx-xfrm.R
│   └── testthat.R
└── tools/
    └── winlibs.R
```

## Significant Files and Folders

### Root Directory

-   **`DESCRIPTION`**: Standard R package metadata file. It contains information like package name, version, author, license, dependencies, and a brief description. This is crucial for R's package management system.
-   **`NAMESPACE`**: Defines the functions imported from other packages and the functions exported by this package for users. Essential for managing R package scope and dependencies.
-   **`README.md`**: (This file was recently updated) Provides a human-readable overview of the project, its purpose, key functionalities, setup instructions, usage examples, and high-level architecture. Serves as the primary entry point for understanding the package.
    -   `README.Rmd`: The R Markdown source file that generates `README.md`. Changes to the README should ideally be made here and then knitted.
-   **`NEWS.md`**: Tracks changes, new features, and bug fixes across different versions of the package.
-   **`rvg.Rproj`**: RStudio project file. Helps in managing the project within the RStudio IDE, storing project-specific settings.
-   **`.gitignore`**: Specifies intentionally untracked files that Git should ignore (e.g., build artifacts, local configuration files).
-   **`.Rbuildignore`**: Specifies files to be excluded when building the R package.
-   **`_pkgdown.yml`**: Configuration file for the `pkgdown` package, used to build a website for the R package.
-   **`cran-comments.md`**: Comments for CRAN maintainers when submitting the package.

### `.github/`

-   **`workflows/`**: Contains GitHub Actions workflow configuration files.
    -   **`R-CMD-check.yaml`**: Defines a CI workflow that runs `R CMD check` on the package for various R versions and operating systems. This ensures package integrity and adherence to CRAN standards.
    -   **`pkgdown.yaml`**: Defines a CI workflow that builds and deploys the package documentation website using `pkgdown`.

### `R/`

This directory contains the R source code files that define the package's functions and logic.

-   **`RcppExports.R`**: Automatically generated by Rcpp. Contains R wrappers for the C++ functions defined in `src/`. Users typically don't edit this directly.
-   **`dml_pptx.R`**: Implements the `dml_pptx()` graphics device, which is responsible for generating DrawingML output specifically for PowerPoint. This is a core component for PowerPoint integration.
-   **`dml_xlsx.R`**: Implements the `dml_xlsx()` graphics device, similar to `dml_pptx.R` but tailored for Excel. Core for Excel integration.
-   **`fonts.R`**: Contains logic related to font handling and mapping for the vector graphics output.
-   **`ph_with_vg.R`**: Provides helper functions, likely related to `officer` package integration, for placing vector graphics (`vg`) into PowerPoint placeholders (`ph`). (Note: `ph_with.dml.Rd` suggests this might be where S3 methods for `officer::ph_with` for `dml` objects are defined).
-   **`xl_add_vg.R`**: Contains functions for adding vector graphics to Excel sheets, likely working in conjunction with the `officer` package. (Note: `xl_add_vg.Rd` suggests this might define S3 methods for `officer::xl_add_vg` for `dml` objects).
-   **`defunct.R`**: Lists functions that have been removed or superseded (deprecated) in the package.

### `src/`

This directory contains C++ source code, primarily used with `Rcpp` to accelerate performance-intensive operations involved in generating XML for DrawingML.

-   **`RcppExports.cpp`**: Automatically generated by Rcpp. Contains the C++ function implementations that are callable from R. Users typically don't edit this directly.
-   **`*.cpp`, `*.h` (various files)**: These are the C++ source and header files. They implement the low-level details of XML node creation, coordinate transformations, color handling, shape definitions, text rendering, and other aspects of DrawingML generation.
    -   `pptx.cpp` / `xlsx.cpp`: Likely contain main C++ logic for PowerPoint and Excel specific DrawingML generation.
    -   `main_tree.cpp`, `ooxml_dev.h`: Suggest core structures for building the XML tree (Office Open XML device).
    -   `a_color.cpp`, `line_style.cpp`, `shapes.cpp`, `text.cpp`, `raster.cpp`: Handle specific graphical elements.
    -   `clipper.cpp`: Likely implements polygon clipping algorithms, important for handling complex shapes.
-   **`Makevars`, `Makevars.win`, `Makevars.ucrt`**: Build configuration files for compiling the C++ code on different platforms (Unix-like, Windows).

### `man/`

Contains documentation files in R's Rich Documentation (Rd) format. These files are used to generate the help pages for each function in the package.

-   **`*.Rd`**: Each `.Rd` file corresponds to a function or dataset exported by the package (e.g., `dml.Rd`, `dml_pptx.Rd`). They describe the function's purpose, arguments, return values, and provide usage examples.

### `tests/`

Contains files for unit testing the package, ensuring its reliability and correctness.

-   **`testthat.R`**: Main test runner script, typically used with the `testthat` package.
-   **`testthat/`**: Directory containing individual test files.
    -   **`test-*.R`**: Each file contains a suite of tests for a specific functionality or module (e.g., `test-dml-editable.R`, `test-pptx-lines.R`). These scripts use `testthat` functions to define expected outcomes and check if the package functions behave as intended.

### `inst/`

This directory contains auxiliary files that need to be installed along with the package.

-   **`logo.svg`**: An SVG image file, likely the logo for the package, which might be used in documentation or websites.

### `tools/`

Contains utility scripts that aid in package development or maintenance but are not part of the package itself.

-   **`winlibs.R`**: Script likely used for managing or downloading Windows-specific C++ libraries (dependencies) required for building the package on Windows.

## Naming Conventions, Design Patterns, and Architectural Choices

-   **R Package Structure**: Follows the standard R package directory structure.
-   **S3 Methods**: The package appears to use S3 methods for generic functions like `ph_with` and `xl_add_vg` (from the `officer` package) to handle its custom `dml` objects. This is a common design pattern in R for extending functionality. (e.g., `ph_with.dml` would be the S3 method for `ph_with` when the object is of class `dml`).
-   **Rcpp for Performance**: C++ is used via `Rcpp` for computationally intensive tasks, particularly the generation of DrawingML XML. This is a common strategy in R packages to improve performance.
-   **Graphics Devices**: The core functionality revolves around custom R graphics devices (`dml_pptx`, `dml_xlsx`) that intercept R plotting commands and translate them into DrawingML.
-   **Separation of Concerns**:
    -   R code in `R/` handles the user-facing API and interaction with R's graphics system.
    -   C++ code in `src/` handles the low-level, performance-critical DrawingML generation.
    -   Integration with `officer` package: `rvg` focuses on generating the DrawingML content, while `officer` is used for embedding this content into actual `.pptx` and `.xlsx` files.
-   **File Naming**:
    -   R scripts in `R/` are named descriptively based on their primary function (e.g., `dml_pptx.R`).
    -   Test files in `tests/testthat/` are prefixed with `test-` and describe the functionality being tested.
    -   C++ files in `src/` also have descriptive names related to their content (e.g., `shapes.cpp`, `text.cpp`).
-   **Modularity**: The C++ code appears to be modular, with different aspects of DrawingML (colors, shapes, text) handled in separate files.

This manifest should provide a good overview for anyone looking to understand or contribute to the `rvg` package.
